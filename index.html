<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ç‚¹å• â€” çº¢ç™½é£æ ¼</title>
  <meta name="description" content="çº¢ç™½é£æ ¼ç‚¹å•é¡µ â€” åˆ†ç±»ã€å•†å“ã€è´­ç‰©è½¦ï¼Œé€‚é…æ‰‹æœºï¼ˆå¯éƒ¨ç½²åˆ° GitHub Pagesï¼‰">
  <style>
    /* ---------- åŸºç¡€ ---------- */
    :root{
      --brand:#C00;          /* è‚¯å¾·åŸºé£æ ¼çº¢ */
      --accent:#fff;
      --muted:#888;
      --bg:#fafafa;
      --card-radius:14px;
      --gap:12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family: -apple-system,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei",Arial;
      background: linear-gradient(180deg, #fff 0%, var(--bg) 100%);
      color:#222;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom:90px; /* ä¸ºåº•éƒ¨è´­ç‰©æ é¢„ç•™ */
    }

    /* ---------- é¡¶éƒ¨ ---------- */
    .topbar{
      position:sticky; top:0; z-index:30;
      background:linear-gradient(90deg,var(--brand),#e53935);
      color:var(--accent); padding:14px 12px;
      display:flex; align-items:center; justify-content:space-between;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }
    .brand{
      display:flex; gap:10px; align-items:center;
      font-weight:800; font-size:18px;
    }
    .brand .logo{
      width:36px; height:36px; border-radius:8px;
      background:var(--accent); display:flex; align-items:center; justify-content:center;
      color:var(--brand); font-weight:900; font-size:16px;
    }
    .search-btn{
      background: rgba(255,255,255,0.15); color:#fff; border:0; padding:8px 10px; border-radius:8px;
      font-size:14px; cursor:pointer;
    }

    /* ---------- åˆ†ç±»æ ï¼ˆæ¨ªå‘ï¼‰ ---------- */
    .cat-wrap{ background:transparent; padding:10px 8px; overflow-x:auto; -webkit-overflow-scrolling:touch; }
    .cats{ display:flex; gap:10px; align-items:center; padding-bottom:6px; }
    .cat{
      white-space:nowrap; padding:8px 14px; border-radius:20px; cursor:pointer;
      background:rgba(255,255,255,0.95); color:#000; font-weight:600; font-size:14px;
      box-shadow:0 2px 6px rgba(0,0,0,0.06);
    }
    .cat.active{ background:var(--brand); color:var(--accent); box-shadow:0 6px 18px rgba(197,0,0,0.18); }

    /* ---------- é¡µé¢ä¸»ä½“ ---------- */
    .container{ max-width:980px; margin:14px auto; padding:0 12px; }
    .grid{ display:grid; gap:var(--gap); grid-template-columns: repeat(2, 1fr); }
    @media (min-width:900px){ .grid{ grid-template-columns: repeat(3, 1fr); } }
    @media (max-width:520px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      background: #fff; border-radius:var(--card-radius); overflow:hidden;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      display:flex; flex-direction:column;
      transition: transform 160ms ease, box-shadow 160ms ease;
    }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 12px 30px rgba(0,0,0,0.09); }

    .card .media{
      width:100%; height:160px; object-fit:cover; display:block;
      background:#f3f3f3;
    }
    .card-body{ padding:12px 12px 14px 12px; display:flex; flex-direction:column; gap:8px; flex:1; }
    .meta{ display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .title{ font-weight:700; font-size:15px; }
    .desc{ font-size:13px; color:var(--muted); margin-top:4px; }
    .price{ color:var(--brand); font-weight:800; font-size:16px; }
    .addbtn{ margin-left:auto; background:var(--brand); color:var(--accent); border:0; padding:8px 10px; border-radius:10px; cursor:pointer; font-weight:700; }

    /* ---------- åº•éƒ¨ç²˜æ€§è´­ç‰©æ  ---------- */
    .sticky-cart{
      position:fixed; left:0; right:0; bottom:10px; z-index:40;
      display:flex; justify-content:center; pointer-events:none;
    }
    .cartbar{
      width:calc(100% - 24px); max-width:980px;
      background:linear-gradient(90deg,var(--brand),#e53935);
      color:white; border-radius:14px; padding:12px; display:flex; align-items:center; gap:12px;
      box-shadow:0 12px 30px rgba(197,0,0,0.18);
      pointer-events:auto;
    }
    .cart-summary{ flex:1; display:flex; align-items:center; gap:12px; }
    .cart-icon{ width:44px; height:44px; border-radius:10px; background:rgba(255,255,255,0.16); display:flex; align-items:center; justify-content:center; font-weight:800; }
    .cart-qty{ font-weight:800; font-size:16px; }
    .cart-total{ font-weight:800; font-size:16px; }
    .checkout-btn{ background:#fff; color:var(--brand); border:0; padding:10px 14px; border-radius:10px; font-weight:800; cursor:pointer; }

    /* ---------- è´­ç‰©è½¦å¼¹å‡ºé¢æ¿ï¼ˆæ¨¡æ€ï¼‰ ---------- */
    .modal{
      position:fixed; left:0; right:0; bottom:0; top:0; z-index:60; display:none;
      background: rgba(0,0,0,0.4); align-items:flex-end; justify-content:center;
    }
    .modal.open{ display:flex; }
    .drawer{
      width:100%; max-width:980px; background:#fff; border-radius:16px 16px 0 0; padding:14px; max-height:84vh; overflow:auto;
    }
    .drawer h3{ margin:0 0 8px 0; }
    .cart-item{ display:flex; gap:12px; align-items:center; padding:10px 0; border-bottom:1px solid #f2f2f2; }
    .cart-item img{ width:72px; height:72px; border-radius:8px; object-fit:cover; }
    .qty-controls{ display:flex; gap:8px; align-items:center; margin-left:auto; }
    .qty-controls button{ width:34px; height:34px; border-radius:8px; border:0; background:var(--brand); color:#fff; font-weight:700; cursor:pointer; }
    .clear-cart{ background:#eee; border:0; padding:8px 10px; border-radius:8px; cursor:pointer; }

    /* å°å±ä¼˜åŒ– */
    @media (max-width:420px){
      .brand{ font-size:16px }
      .card .media{ height:140px }
      .cartbar{ padding:10px; gap:8px; }
      .checkout-btn{ padding:8px 10px; font-size:14px; }
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨ -->
  <div class="topbar">
    <div class="brand">
      <div class="logo">KD</div>
      K-Delicious ç‚¹å•
    </div>
    <button class="search-btn" onclick="alert('æœç´¢åŠŸèƒ½å¯åç»­æ·»åŠ ')">ğŸ” æœç´¢</button>
  </div>

  <!-- åˆ†ç±» -->
  <div class="cat-wrap">
    <div class="cats container" id="cats"></div>
  </div>

  <!-- ä¸»ä½“ -->
  <div class="container">
    <div id="list" class="grid"></div>
  </div>

  <!-- ç²˜æ€§è´­ç‰©æ  -->
  <div class="sticky-cart">
    <div class="cartbar" role="button" onclick="openCart()" aria-label="æ‰“å¼€è´­ç‰©è½¦">
      <div class="cart-summary">
        <div class="cart-icon">ğŸ›’</div>
        <div>
          <div class="cart-qty" id="cartQty">0 ä»¶</div>
          <div style="font-size:12px; opacity:0.9">è´­ç‰©è½¦å†…å•†å“</div>
        </div>
        <div style="margin-left:8px">
          <div style="font-size:12px; opacity:0.9">åˆè®¡</div>
          <div class="cart-total" id="cartTotal">ï¿¥0</div>
        </div>
      </div>
      <button class="checkout-btn" onclick="event.stopPropagation(); goCheckout()">å»ç»“ç®—</button>
    </div>
  </div>

  <!-- è´­ç‰©è½¦æ¨¡æ€ -->
  <div class="modal" id="modal">
    <div class="drawer" role="dialog" aria-modal="true" id="drawer">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <h3>ä½ çš„è´­ç‰©è½¦</h3>
        <div>
          <button class="clear-cart" onclick="clearCart()">æ¸…ç©º</button>
          <button class="clear-cart" onclick="closeCart()" style="margin-left:8px">å…³é—­</button>
        </div>
      </div>
      <div id="cartList" style="margin-top:12px"></div>
      <div style="margin-top:12px; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div class="small">æ€»è®¡</div>
          <div style="font-weight:900; font-size:18px" id="drawerTotal">ï¿¥0</div>
        </div>
        <div>
          <button class="checkout-btn" onclick="goCheckout()">ç«‹å³ä¸‹å•</button>
        </div>
      </div>
    </div>
  </div>

<script>
/* ==========================
   æ•°æ®ï¼šåˆ†ç±» + å•†å“ï¼ˆç¤ºä¾‹ï¼‰
   - å¯æ ¹æ®éœ€è¦ä¿®æ”¹ PRODUCTS æ•°ç»„å†…å†…å®¹æˆ–å›¾ç‰‡é“¾æ¥
   ========================== */
const CATEGORIES = [
  { id: 'all', name: 'å…¨éƒ¨' },
  { id: 'burger', name: 'æ±‰å ¡' },
  { id: 'chicken', name: 'ç‚¸é¸¡' },
  { id: 'snack', name: 'å°é£Ÿ' },
  { id: 'drink', name: 'é¥®å“' },
  { id: 'dessert', name: 'ç”œå“' },
];

const PRODUCTS = [
  // æ±‰å ¡
  { id: 'b1', cat: 'burger', name: 'çš‡å®¶ç»å…¸æ±‰å ¡', desc:'åŒå±‚ç‰›è‚‰ï¼ŒèŠå£«ç•ªèŒ„', price:28, img:'https://images.unsplash.com/photo-1606756790123-1b9f5b9f95a0?w=900&auto=format&fit=crop&q=60' },
  { id: 'b2', cat: 'burger', name: 'èŠå£«ç‰›å ¡', desc:'æµ“éƒèŠå£«ï¼Œè‚‰æ±æ»¡æº¢', price:32, img:'https://images.unsplash.com/photo-1550547660-d9450f859349?w=900&auto=format&fit=crop&q=60' },
  { id: 'b3', cat: 'burger', name: 'é¸¡è…¿å ¡', desc:'é¦™å«©é¸¡è…¿é…ç‰¹åˆ¶é…±', price:24, img:'https://images.unsplash.com/photo-1545093145-4a4f7d7b1c2b?w=900&auto=format&fit=crop&q=60' },

  // ç‚¸é¸¡
  { id: 'c1', cat: 'chicken', name: 'åŸå‘³ç‚¸é¸¡ï¼ˆå•å—ï¼‰', desc:'å¤–è„†é‡Œå«©ï¼Œå¤šæ±', price:12, img:'https://images.unsplash.com/photo-1604909053442-3b1df9d3ebd6?w=900&auto=format&fit=crop&q=60' },
  { id: 'c2', cat: 'chicken', name: 'é¦™è¾£ç‚¸é¸¡ï¼ˆå•å—ï¼‰', desc:'å¾®è¾£å…¥å‘³ï¼Œé¦™é…¥', price:13, img:'https://images.unsplash.com/photo-1606756790361-8afe9a0e6f3a?w=900&auto=format&fit=crop&q=60' },
  { id: 'c3', cat: 'chicken', name: 'ç‚¸é¸¡æ¡¶ï¼ˆ6å—ï¼‰', desc:'å®¶åº­åˆ†äº«è£…', price:68, img:'https://images.unsplash.com/photo-1598514983289-7c45fbf0a4e9?w=900&auto=format&fit=crop&q=60' },

  // å°é£Ÿ
  { id: 's1', cat: 'snack', name: 'ç»å…¸è–¯æ¡', desc:'é»„é‡‘è„†è–¯', price:12, img:'https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=900&auto=format&fit=crop&q=60' },
  { id: 's2', cat: 'snack', name: 'é¦™è‘±é¸¡ç±³èŠ±', desc:'ä¸€å£ä¸€ä¸ªçš„å¿«ä¹', price:18, img:'https://images.unsplash.com/photo-1612874742237-652a524bcb99?w=900&auto=format&fit=crop&q=60' },
  { id: 's3', cat: 'snack', name: 'ç‰ç±³æ¯', desc:'é¦™ç”œç‰ç±³', price:9, img:'https://images.unsplash.com/photo-1617191516755-1c2f0be2f1a0?w=900&auto=format&fit=crop&q=60' },

  // é¥®å“
  { id: 'd1', cat: 'drink', name: 'å¯ä¹ï¼ˆä¸­ï¼‰', desc:'å†°çˆ½å¯å£', price:8, img:'https://images.unsplash.com/photo-1601050690597-df7d07e6b47f?w=900&auto=format&fit=crop&q=60' },
  { id: 'd2', cat: 'drink', name: 'å†°æŸ æª¬èŒ¶', desc:'æ¸…æ–°è§£æ¸´', price:10, img:'https://images.unsplash.com/photo-1532634896-26909d0d1b45?w=900&auto=format&fit=crop&q=60' },
  { id: 'd3', cat: 'drink', name: 'çƒ­ç¾å¼', desc:'çº¯ç²¹å’–å•¡é¦™', price:16, img:'https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=900&auto=format&fit=crop&q=60' },

  // ç”œå“
  { id: 'e1', cat: 'dessert', name: 'è‰è“åœ£ä»£', desc:'é¦™ç”œè‰è“+å†°æ·‡æ·‹', price:12, img:'https://images.unsplash.com/photo-1505250469679-203ad9ced0cb?w=900&auto=format&fit=crop&q=60' },
  { id: 'e2', cat: 'dessert', name: 'å·§å…‹åŠ›æ´¾', desc:'æµ“éƒå·§å…‹åŠ›', price:14, img:'https://images.unsplash.com/photo-1542444459-db1b8f6b7a0b?w=900&auto=format&fit=crop&q=60' },
];

/* ============= æœ¬åœ°è´­ç‰©è½¦å­˜å‚¨ ============= */
const CART_KEY = 'kd_order_cart_v3';
function readCart(){
  try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); }
  catch(e){ return []; }
}
function saveCart(cart){
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
  renderCartBar();
}

/* ============= æ¸²æŸ“åˆ†ç±» ============= */
const catsEl = document.getElementById('cats');
let activeCat = 'all';
function renderCats(){
  catsEl.innerHTML = CATEGORIES.map(c => `<div class="cat ${c.id===activeCat? 'active':''}" data-id="${c.id}">${c.name}</div>`).join('');
  // ç»‘å®šäº‹ä»¶
  catsEl.querySelectorAll('.cat').forEach(el=>{
    el.addEventListener('click', ()=>{
      activeCat = el.dataset.id;
      renderCats(); renderList();
    });
  });
}

/* ============= æ¸²æŸ“å•†å“åˆ—è¡¨ ============= */
const listEl = document.getElementById('list');
function renderList(){
  const items = PRODUCTS.filter(p => (activeCat==='all' || p.cat===activeCat));
  listEl.innerHTML = items.map(p => `
    <div class="card">
      <img class="media" src="${p.img}" alt="${escapeHtml(p.name)}" loading="lazy">
      <div class="card-body">
        <div>
          <div class="meta">
            <div>
              <div class="title">${escapeHtml(p.name)}</div>
              <div class="desc">${escapeHtml(p.desc)}</div>
            </div>
            <div style="text-align:right">
              <div class="price">ï¿¥${p.price}</div>
            </div>
          </div>
        </div>
        <div style="display:flex; align-items:center; gap:8px; margin-top:8px;">
          <button class="addbtn" data-id="${p.id}">ï¼‹ åŠ å…¥</button>
        </div>
      </div>
    </div>
  `).join('');

  // ç»‘å®šåŠ å…¥æŒ‰é’®
  listEl.querySelectorAll('.addbtn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const id = btn.dataset.id;
      addToCart(id);
      // å°åŠ¨ç”»æç¤º
      btn.innerText = 'å·²åŠ å…¥';
      setTimeout(()=> btn.innerText = 'ï¼‹ åŠ å…¥', 800);
    });
  });
}

/* ============= è´­ç‰©è½¦æ“ä½œ ============= */
function addToCart(id, qty=1){
  const product = PRODUCTS.find(p=>p.id===id);
  if(!product) return;
  const cart = readCart();
  const it = cart.find(x=>x.id===id);
  if(it) it.count += qty;
  else cart.push({ id:product.id, name:product.name, price:product.price, img:product.img, count:qty });
  saveCart(cart);
}
function removeFromCart(id){
  let cart = readCart();
  cart = cart.filter(x=>x.id!==id);
  saveCart(cart);
}
function updateCount(id, newCount){
  const cart = readCart();
  const it = cart.find(x=>x.id===id);
  if(!it) return;
  it.count = Math.max(0, newCount);
  const filtered = cart.filter(x=>x.count>0);
  saveCart(filtered);
}

/* ============= æ¸²æŸ“åº•éƒ¨è´­ç‰©æ  ============= */
function renderCartBar(){
  const cart = readCart();
  const qty = cart.reduce((s,i)=>s+i.count,0);
  const total = cart.reduce((s,i)=>s + i.price * i.count, 0);
  document.getElementById('cartQty').innerText = qty + ' ä»¶';
  document.getElementById('cartTotal').innerText = 'ï¿¥' + total;
}

/* ============= è´­ç‰©è½¦æŠ½å±‰ï¼ˆæ¨¡æ€ï¼‰ ============= */
const modal = document.getElementById('modal');
function openCart(){
  renderCartDrawer();
  modal.classList.add('open');
}
function closeCart(){
  modal.classList.remove('open');
}
function renderCartDrawer(){
  const container = document.getElementById('cartList');
  const cart = readCart();
  if(cart.length===0){
    container.innerHTML = '<div style="padding:18px; text-align:center; color:#666;">è´­ç‰©è½¦ç©ºï¼Œå¿«å»é€‰è´­å¿ƒä»ªçš„ç¾é£Ÿå§ï¼</div>';
  } else {
    container.innerHTML = cart.map(item => `
      <div class="cart-item">
        <img src="${item.img}" alt="${escapeHtml(item.name)}">
        <div style="flex:1">
          <div style="font-weight:800">${escapeHtml(item.name)}</div>
          <div class="small">å•ä»· ï¿¥${item.price}</div>
        </div>
        <div class="qty-controls">
          <button onclick="decreaseQty('${item.id}')">âˆ’</button>
          <div style="min-width:28px; text-align:center">${item.count}</div>
          <button onclick="increaseQty('${item.id}')">ï¼‹</button>
        </div>
      </div>
    `).join('');
  }
  document.getElementById('drawerTotal').innerText = 'ï¿¥' + cart.reduce((s,i)=> s + i.price * i.count, 0);
}

/* å¤–éƒ¨æ–¹æ³•ä»¥ä¾¿ç»‘å®šåœ¨ HTML ä¸­ */
function increaseQty(id){ updateCount(id, getCount(id)+1); renderCartDrawer(); }
function decreaseQty(id){ updateCount(id, getCount(id)-1); renderCartDrawer(); }
function getCount(id){ const cart = readCart(); const it = cart.find(x=>x.id===id); return it ? it.count : 0; }
function clearCart(){ if(confirm('ç¡®å®šæ¸…ç©ºè´­ç‰©è½¦å—ï¼Ÿ')){ saveCart([]); renderCartDrawer(); closeCart(); } }

/* ============= ç»“ç®—é€»è¾‘ï¼ˆæœ¬ç¤ºä¾‹ä»…æœ¬åœ°ä¿å­˜è®¢å•ï¼‰ ============= */
function goCheckout(){
  const cart = readCart();
  if(cart.length===0){ alert('è´­ç‰©è½¦ä¸ºç©º'); return; }
  // ç®€å•ä¸‹å•ï¼šå­˜å‚¨ LAST_ORDER å¹¶æ¸…ç©ºè´­ç‰©è½¦
  const order = { id: 'ORD' + Date.now(), created: Date.now(), items: cart, total: cart.reduce((s,i)=>s+i.price*i.count,0) };
  localStorage.setItem('LAST_ORDER', JSON.stringify(order));
  saveCart([]);
  closeCart();
  renderOrderSuccess(order);
}

/* ä¸‹å•æˆåŠŸæ˜¾ç¤º */
function renderOrderSuccess(order){
  // ä½ å¯ä»¥å®šåˆ¶æˆå¼¹çª—æˆ–è·³é¡µé¢ï¼›è¿™é‡Œé‡‡ç”¨ç®€å•æç¤ºå¹¶æ»šåŠ¨åˆ°é¡¶éƒ¨å±•ç¤ºè®¢å•ä¿¡æ¯
  window.scrollTo({ top: 0, behavior: 'smooth' });
  alert('ä¸‹å•æˆåŠŸï¼è®¢å•å·ï¼š' + order.id + '\\næ€»è®¡ï¼šï¿¥' + order.total);
  // å¯åœ¨é¡µé¢é¡¶éƒ¨ç®€å•æ˜¾ç¤ºæœ€è¿‘è®¢å•
  // è¿™é‡Œå°†æœ€è¿‘è®¢å•æ’å…¥åˆ° container ä¸Šæ–¹ï¼ˆè‹¥éœ€æ°¸ä¹…å­˜åœ¨å¯æ‰©å±•ï¼‰
  const container = document.querySelector('.container');
  const node = document.createElement('div');
  node.style.margin = '14px 12px';
  node.style.padding = '12px';
  node.style.borderRadius = '12px';
  node.style.background = '#fff';
  node.style.boxShadow = '0 8px 20px rgba(0,0,0,0.06)';
  node.innerHTML = '<div style=\"display:flex;justify-content:space-between;align-items:center\"><div><strong>æœ€è¿‘è®¢å•</strong><div class=\"small\">è®¢å•å·ï¼š'+order.id+'</div></div><div style=\"font-weight:900\">æ€»è®¡ï¼šï¿¥'+order.total+'</div></div>';
  container.insertAdjacentElement('afterbegin', node);
}

/* ========= åˆå§‹åŒ– ========= */
renderCats();
renderList();
renderCartBar();

/* ç‚¹å‡»ç©ºç™½å¤„å…³é—­è´­ç‰©æŠ½å±‰ */
modal.addEventListener('click', (e)=>{
  if(e.target === modal) closeCart();
});

/* å°å·¥å…·ï¼šé˜² XSS çš„ç®€å•è½¬ä¹‰ï¼ˆä»…ç”¨äºæ’å…¥æ–‡æœ¬ï¼‰ */
function escapeHtml(s){
  if(!s) return '';
  return String(s).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
}
</script>
</body>
</html>
